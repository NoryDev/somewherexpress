<div class="container">
  <div class="row">
    <div class="col-xs-12 col-md-8 col-md-offset-2">
      <!-- START DESCRIPTION -->
      <h1><%= @competition %></h1>

      <div class="text-center">
        <p class="lead"><%= @competition.start_location_locality %> – <%= @competition.end_location_locality %></p>
        <p class="text-uppercase text-muted small"><%= date_format(@competition.start_date) %> – <%= date_format(@competition.end_date) %>
        </p>
        <p>
          <% @competition.users.each do |user| %>
            <%= link_to user do %>
              <%= image_tag user.avatar, class: "avatar", data: {toggle: "tooltip", placement: "bottom"}, title: "#{user}", alt: "#{user.first_name}" %>
            <% end %>
          <% end %>
        </p>

        <% if Subscription.where(user: current_user, competition: @competition ).present? %>
          <%= link_to 'Cancel my registration', subscription_path(Subscription.where(user: current_user, competition: @competition).take), method: :delete %>
        <% else %>
          <!-- APPLY -->
          <%= simple_form_for Subscription.new do |f| %>
            <%= f.error_notification %>
            <%= f.association :competition, as: :hidden, input_html: { value: @competition.id } %>
            <%= f.button :submit, "Apply", class: "navbar-wagon-button btn", style: "margin: 20px 0;" %>
          <% end %>
        <% end %>

        <!-- EDIT -->
        <%= link_to "#{t('.edit.title')}", edit_competition_path(@competition) %>
      </div>
      <!-- END DESCRIPTION -->

      <div id="map" style="width: 100%; height: 400px;"></div>

      <% if @competition.multiple_tracks? %>
        <%= render 'multi_tracks', competition: @competition %>
      <% else %>
        <%= render 'mono_track', competition: @competition %>
      <% end %>

      <div class="text-center">
        <% if Subscription.where(user: current_user, competition: @competition ).present? %>
          <%= link_to 'Cancel my registration', subscription_path(Subscription.where(user: current_user, competition: @competition).take), method: :delete %>
        <% else %>
          <!-- APPLY -->
          <%= simple_form_for Subscription.new do |f| %>
            <%= f.error_notification %>
            <%= f.association :competition, as: :hidden, input_html: { value: @competition.id } %>
            <%= f.button :submit, "Apply", class: "navbar-wagon-button btn", style: "margin: 20px 0;" %>
          <% end %>
        <% end %>
      </div>

    </div>
  </div>
</div>
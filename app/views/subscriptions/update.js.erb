<% if @form.errors.any? %>
  // Render new review form with errors
  $("#modal-content-sub-<%= @form.id %>").html("<%= j render 'subscriptions/process', subscription: @form, competition: @competition, user: @form.user %>");
<% else %>
  $("#modal-sub-<%= @form.id %>").modal('hide');

  <%# Dashboard of creator: update number of pending %>
  <% if current_user.pending_registrations_for_creations > 0 %>
    $('.registrations-alert').html("<%= current_user.pending_registrations_for_creations %>");
  <% else %>
    $('.registrations-alert').hide();
  <% end %>

  <% if @form.status == "accepted" %>
    <%# Add avatar to card: reload card? %>
    $("#panel-<%= @competition.id %> .users-area").append("<%= j render 'users/avatar_small', user: @form.user %>")

    $("#subscription-<%= @form.id%>-pending").remove();
    $("#competition-<%= @competition.id%>-accepted").append("<%= j render 'competitions/accepted_user', competition: @competition, user: @form.user %>")

    <%# reload tooltip because bootstrap %>
    $('[data-toggle="tooltip"]').tooltip();
  <% elsif @form.status == "refused" %>
    <%# Add avatar to card: reload card? %>
    $("#panel-<%= @competition.id %> .users-area").append("<%= j render 'users/avatar_small', user: @form.user %>")

    $("#subscription-<%= @form.id%>-pending").remove();
    $("#competition-<%= @competition.id%>-refused").append("<%= j render 'competitions/refused_user', competition: @competition, user: @form.user %>")

    <%# reload tooltip because bootstrap %>
    $('[data-toggle="tooltip"]').tooltip();
  <% end %>
<% end %>
